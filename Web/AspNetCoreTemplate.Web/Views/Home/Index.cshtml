@model AspNetCoreTemplate.Web.ViewModels.Posts.ListPostsViewModel
@{

    ViewData["Title"] = "Home Page";
}

<!--FIX PHOTOS (DOWNLOAD THEM)-->

<link href="~/css/post.css" />
<!-- Card -->
<div class="container">
    @foreach (var post in Model.Posts)
    {
        <div class="card promoting-card col-md-8" style="display:inline-block">
            <!-- Card content -->
            <div class="card-body d-flex flex-row">
                <!-- Avatar -->
                <img src="https://mdbootstrap.com/img/Photos/Avatars/avatar-8.jpg" class="rounded-circle mr-3" height="50px" width="50px" alt="avatar">
                <!-- Content -->
                <div>
                    <!-- Title -->
                    <h4 class="card-title font-weight-bold mb-2">@post.Title</h4>
                    <!-- Subtitle -->
                    <p class="card-text"><i class="far fa-clock pr-2"></i>@post.CreatedOn</p>
                </div>
            </div>
            <!-- Card image -->
            <div class="view overlay">
                <img class="card-img-top rounded-0" src="@post.ImageURL" alt="Card image cap">
                <a href="#!">
                    <div class="mask rgba-white-slight"></div>
                </a>
            </div>
            <!-- Card content -->
            <div class="card-body">
                <div class="collapse-content">
                    <!-- Text -->
                    <p class="card-text collapse" id="collapseContent">@post.Description</p>
                    <!-- Button -->
                    <a>@post.Likes Likes</a>
                    <a>10 Comments</a>
                    <a class="btn btn-flat red-text p-1 my-1 mr-0 mml-1 collapsed" data-toggle="collapse" href="#collapseContent" aria-expanded="false" aria-controls="collapseContent"></a>
                    <i class="fas fa-share-alt text-muted float-right p-1 my-1" data-toggle="tooltip" data-placement="top" title="Share this post"> Share</i>
                    <i class="fas fa-comments text-muted float-right p-1 my-1 mr-3" data-toggle="tooltip" data-placement="top" title="I like it"> Comment</i>
                    <a class="fas fa-heart text-muted float-right p-1 my-1 mr-3" data-toggle="tooltip" data-placement="top" title="I like it" asp-controller="Posts" asp-action="Like"> Like</a>
                </div>
            </div>
        </div>
    }
    <div class="col-md-6">
        <div class="card-header">
            Recent
        </div>
        <ul class="list-group list-group-flush">
            <li class="list-group-item"> |   </li>
        </ul>
    </div>
    <!-- Card -->
</div>

<script>

    function sendVote(postId) {
        var token = $("#votesForm input[name=__RequestVerificationToken]").val();
        var json = { postId: postId };
        $.ajax({
            url: "/api/likes",
            type: "POST",
            data: JSON.stringify(json),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            headers: { 'X-CSRF-TOKEN': token },
            success: function (data) {
                $("#votesCount").html(data.votesCount);
            }
        });
    }
</script>